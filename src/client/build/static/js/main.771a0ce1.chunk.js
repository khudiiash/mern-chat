(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{238:function(e,t,a){},239:function(e,t,a){"use strict";a.r(t);var n=a(6),r={items:[]};t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r,t=arguments.length>1?arguments[1]:void 0,a=t.type,i=t.payload;switch(a){case"ATTACHMENTS:SET_ITEMS":return Object(n.a)({},e,{items:i});case"ATTACHMENTS:REMOVE_ITEM":return Object(n.a)({},e,{items:e.items.filter(function(e){return e.uid!==i.uid})});default:return e}}},240:function(e,t,a){"use strict";a.r(t);var n=a(6),r={items:[],currentDialogId:window.location.pathname.split("dialog/")[1],isLoading:!1};t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r,t=arguments.length>1?arguments[1]:void 0,a=t.type,i=t.payload;switch(a){case"DIALOGS:SET_ITEMS":return Object(n.a)({},e,{items:i});case"DIALOGS:SET_TYPING_IN_DIALOG":return Object(n.a)({},e,{typingInDialogWithId:i});case"DIALOGS:LAST_MESSAGE_READ_STATUS":return Object(n.a)({},e,{items:e.items.map(function(e){return e._id===i.dialogId&&i.currentDialogId===i.dialogId&&(e.lastMessage.read=!0),e})});case"DIALOGS:SET_CURRENT_DIALOG_ID":return Object(n.a)({},e,{currentDialogId:i});case"DIALOGS:DELETE_DIALOG":return Object(n.a)({},e,{items:e.items.filter(function(e){return e._id!==i})});default:return e}}},241:function(e,t,a){"use strict";a.r(t);var n=a(85),r=a(6),i={items:[],isLoading:!1};t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i,t=arguments.length>1?arguments[1]:void 0,a=t.type,c=t.payload;switch(a){case"MESSAGES:ADD_MESSAGE":return Object(r.a)({},e,{items:[].concat(Object(n.a)(e.items),[c])});case"MESSAGES:SET_ALL_ITEMS":return Object(r.a)({},e,{allItems:c,isLoading:!1});case"MESSAGES:SET_ITEMS":return Object(r.a)({},e,{items:c,isLoading:!1});case"DIALOGS:LAST_MESSAGE_READ_STATUS":return Object(r.a)({},e,{items:e.items.map(function(e){return e.dialog._id===c.dialogId&&(e.read=!0),e})});case"MESSAGES:REMOVE_MESSAGE":return Object(r.a)({},e,{items:e.items.filter(function(e){return e._id!==c})});case"MESSAGES:SET_IS_LOADING":return Object(r.a)({},e,{isLoading:c});default:return e}}},242:function(e,t,a){"use strict";a.r(t);var n=a(6),r={data:null,token:window.localStorage.token,isAuth:!!window.localStorage.token};t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r,t=arguments.length>1?arguments[1]:void 0,a=t.type,i=t.payload;switch(a){case"USER:SET_DATA":return Object(n.a)({},e,{data:i,isAuth:!0,token:window.localStorage.token});case"USER:SET_AVATAR":return Object(n.a)({},e,{data:Object(n.a)({},e.data,{avatar:i.avatar})});case"USER:SET_IS_AUTH":return Object(n.a)({},e,{isAuth:i});case"USER:SET_ONLINE":return Object(n.a)({},e,{data:Object(n.a)({},e.data,{last_seen:new Date,isOnline:!0})});case"USER:SET_CURRENT_DIALOG":return Object(n.a)({},e,{data:Object(n.a)({},e.data,{current_dialog_id:i})});case"USER:SET_OFFLINE":return Object(n.a)({},e,{data:Object(n.a)({},e.data,{last_seen:new Date,isOnline:!1})});default:return e}}},260:function(e,t,a){e.exports=a.p+"static/media/wave.2b8196a5.svg"},261:function(e,t,a){e.exports=a.p+"static/media/play.65f03140.svg"},262:function(e,t,a){e.exports=a.p+"static/media/pause.a61933e8.svg"},264:function(e,t,a){e.exports=a.p+"static/media/read.c1f419d6.svg"},265:function(e,t,a){e.exports=a.p+"static/media/unread.3c841bf6.svg"},274:function(e,t,a){e.exports=a(554)},330:function(e,t){},444:function(e,t,a){},506:function(e,t,a){},507:function(e,t,a){},520:function(e,t,a){},521:function(e,t,a){},534:function(e,t,a){},539:function(e,t,a){},540:function(e,t,a){},549:function(e,t,a){var n={"./":97,"./attachments":239,"./attachments.js":239,"./dialogs":240,"./dialogs.js":240,"./index":97,"./index.js":97,"./messages":241,"./messages.js":241,"./user":242,"./user.js":242};function r(e){var t=i(e);return a(t)}function i(e){var t=n[e];if(!(t+1)){var a=new Error("Cannot find module '"+e+"'");throw a.code="MODULE_NOT_FOUND",a}return t}r.keys=function(){return Object.keys(n)},r.resolve=i,e.exports=r,r.id=549},550:function(e,t,a){},551:function(e,t,a){},552:function(e,t,a){},554:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),i=a(4),c=a.n(i),s=a(41),l=a(14),o=a(45),u=a(132),m=a(560),d=a(561),f=a(8),p=a(556),g=a(61),E=a(562),h=a(6),v=a(13),_=a(104),b=a.n(_);b.a.defaults.baseURL=window.location.origin,b.a.defaults.headers.common.token=window.localStorage.token,window.axios=b.a;var S=b.a,O=function(){return S.get("/dialogs")},y=function(e){return S.get("dialogs/".concat(e))},N=function(e){var t=e.partner,a=e.text;return S.post("/dialogs",{partner:t,text:a})},w=function(e){return S.delete("/dialogs/".concat(e))},j=function(){return S.get("/messages/get-all")},I=function(e){return S.get("/messages?dialog="+e)},A=function(e){return S.delete("/messages?id="+e)},T=function(e,t,a){return S.post("/messages",{text:e,dialog_id:t,attachments:a})},k=function(e){return S.post("/user/signin",e)},D=function(e){return S.post("/user/signup",e)},M=function(e){return S.get("/user/verify?hash="+e)},L=function(){return S.get("/user/me")},R=function(e){return S.get("/user/find?query="+e)},x=function(e){return S.post("/user/setAvatar",e)},C=function(e){return S.post("/user/setOnline",e)},G=function(e){return S.post("/user/setOffline",e)},U=function(e){return S.post("/user/setCurrentDialog",e)},P=function(e){var t=new FormData;return t.append("file",e),S.post("/files",t,{headers:{"Content-Type":"multipart/form-data"}})},V=a(248),F=a.n(V)()(window.location.origin.replace("3000","3003")),z={setDialogs:function(e){return{type:"DIALOGS:SET_ITEMS",payload:e}},setTypingInDialogWithId:function(e){return{type:"DIALOGS:SET_TYPING_IN_DIALOG",payload:e}},updateReadStatus:function(e){return{type:"DIALOGS:LAST_MESSAGE_READ_STATUS",payload:{userId:e.userId,dialogId:e.dialogId}}},setCurrentDialogId:function(e){return function(t){F.emit("DIALOGS:JOIN",e),t({type:"DIALOGS:SET_CURRENT_DIALOG_ID",payload:e})}},fetchDialogs:function(){return function(e){O().then(function(t){var a=t.data;e(z.setDialogs(a))})}},deleteDialog:function(e){return function(t){w(e),t({type:"DIALOGS:DELETE_DIALOG",payload:e})}}},B=z,H={setAllMessages:function(e){return{type:"MESSAGES:SET_ALL_ITEMS",payload:e}},setMessages:function(e){return{type:"MESSAGES:SET_ITEMS",payload:e}},addMessage:function(e){return function(t,a){a().dialogs.currentDialogId===e.dialog._id&&t({type:"MESSAGES:ADD_MESSAGE",payload:e})}},fetchSendMessage:function(e){var t=e.text,a=e.dialogId,n=e.attachments;return function(e){return T(t,a,n)}},setIsLoading:function(e){return{type:"MESSAGES:SET_IS_LOADING",payload:e}},removeMessageById:function(e){return function(t){window.confirm("\u0412\u044b \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u0445\u043e\u0442\u0438\u0442\u0435 \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435?")&&A(e).then(function(a){a.data;t({type:"MESSAGES:REMOVE_MESSAGE",payload:e})}).catch(function(){t(H.setIsLoading(!1))})}},fetchMessages:function(e){return function(t){t(H.setIsLoading(!0)),I(e).then(function(e){var a=e.data;t(H.setMessages(a))}).catch(function(){t(H.setIsLoading(!1))})}}},W=H,Y=function(e,t,a){return t[e]?a[e]?"error":"success":""},Z=a(269),J=a(563),q=function(e){var t={includeSeconds:!1,addSuffix:!1,locale:J.a};return e?"".concat(Object(Z.a)(new Date(e),new Date,t)," \u043d\u0430\u0437\u0430\u0434").replace(/\u043e\u043a\u043e\u043b\u043e /,""):""},X=a(126),K=a.n(X),$=function(e){var t=e.substr(0,3).split("").map(function(e){return(t=e.charCodeAt(0))>255&&4===t.toString().length?parseInt(t.toString().charAt(0)+t.toString().substr(2,3)):t<0?0:t>255?255:t<0?0:t;var t}),a=Object(v.a)(t,3),n=a[0],r=a[1],i=a[2];return{color:K()({r:n,g:r,b:i}).lighten(10).saturate(10).toHexString(),colorLighten:K()({r:n,g:r,b:i}).lighten(30).saturate(30).toHexString()}},Q=a(564),ee=function(e){var t=e.text,a=e.type,n=void 0===a?"info":a,r=e.title,i=e.duration,c=void 0===i?3:i;return Q.a[n]({message:r,description:t,duration:c})},te=function(e){if(!e)return null;var t=e[0];return e.length&&"webm"===t.ext},ae={setUserData:function(e){return{type:"USER:SET_DATA",payload:e}},setIsAuth:function(e){return{type:"USER:SET_IS_AUTH",payload:e}},setAvatar:function(e){return{type:"USER:SET_AVATAR",payload:e}},setCurrentDialog:function(e){return{type:"USER:SET_CURRENT_DIALOG",payload:e}},setOnline:function(e){return{type:"USER:SET_ONLINE",payload:e}},setOffline:function(e){return{type:"USER:SET_OFFLINE",payload:e}},fetchUserData:function(){return function(e){L().then(function(t){var a=t.data;e(ae.setUserData(a))}).catch(function(t){403===t.response.status&&(e(ae.setIsAuth(!1)),delete window.localStorage.token)})}},fetchUserLogin:function(e){return function(t){return k(e).then(function(e){var a=e.data,n=a.token;return ee({title:"\u041e\u0442\u043b\u0438\u0447\u043d\u043e!",text:"\u0410\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u044f \u0443\u0441\u043f\u0435\u0448\u043d\u0430.",type:"success"}),window.axios.defaults.headers.common.token=n,window.localStorage.token=n,t(ae.fetchUserData()),t(ae.setIsAuth(!0)),a}).catch(function(e){e.response;ee({title:"\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u0438",text:"\u041d\u0435\u0432\u0435\u0440\u043d\u044b\u0439 \u043b\u043e\u0433\u0438\u043d \u0438\u043b\u0438 \u043f\u0430\u0440\u043e\u043b\u044c",type:"error"})})}},fetchUserRegister:function(e){return function(){return D(e)}}},ne=ae,re={setAttachments:function(e){return{type:"ATTACHMENTS:SET_ITEMS",payload:e}},removeAttachment:function(e){return{type:"ATTACHMENTS:REMOVE_ITEM",payload:e}}},ie=Object(l.b)(function(e){return e.dialogs},Object(h.a)({},B,W))(function(e){var t=e.fetchDialogs,a=e.updateReadStatus,i=e.currentDialogId,c=e.items,s=e.userId,l=e.user,o=e.setAllMessages;l&&i&&y(i).then(function(e){l.current_dialog_id=i,e.data.author===l._id?l.receiver_id=e.data.partner:e.data.partner===l._id&&(l.receiver_id=e.data.author),U(l)});var u=Object(n.useState)(""),m=Object(v.a)(u,2),d=m[0],f=m[1],p=Object(n.useState)(Array.from(c)),g=Object(v.a)(p,2),E=g[0],h=g[1],_=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";h(c.filter(function(t){return t.author.fullName.toLowerCase().indexOf(e.toLowerCase())>=0||t.partner.fullName.toLowerCase().indexOf(e.toLowerCase())>=0})),f(e)};return window.fetchDialogs=t,Object(n.useEffect)(function(){var e;c.length&&(_(),e=c,j().then(function(t){var a=[];e.forEach(function(e){a.push(t.data.filter(function(t){return t.dialog===e._id}))}),a=[].concat.apply([],a),o(a)}))},[c]),Object(n.useEffect)(function(){return t(),F.on("SERVER:DIALOG_CREATED",t),F.on("SERVER:NEW_MESSAGE",t),F.on("SERVER:MESSAGES_READ",a),function(){F.removeListener("SERVER:DIALOG_CREATED",t),F.removeListener("SERVER:NEW_MESSAGE",t)}},[]),r.a.createElement($e,{userId:s,items:E,onSearch:_,inputValue:d,currentDialogId:i})}),ce=a(86),se=a(251),le=a.n(se),oe=Object(l.b)(function(e){var t=e.dialogs,a=e.messages,n=e.user,r=e.attachments;return{currentDialog:le()(t.items,{_id:t.currentDialogId}),items:a.items,isLoading:a.isLoading,attachments:r.items,date:a.date,user:n.data}},Object(h.a)({},W,B))(function(e){var t=e.currentDialog,a=e.fetchMessages,i=e.addMessage,c=e.items,s=e.user,o=e.isLoading,u=e.removeMessageById,m=e.attachments,d=e.me,f=e.setTypingInDialogWithId;if(!t)return r.a.createElement(ce.a,{description:"\u041e\u0442\u043a\u0440\u043e\u0439\u0442\u0435 \u0434\u0438\u0430\u043b\u043e\u0433"});var p=Object(l.c)(function(e){return e.dialogs.typingInDialogWithId}),g=Object(n.useState)(null),E=Object(v.a)(g,2),h=E[0],_=E[1],b=Object(n.useState)(135),S=Object(v.a)(b,2),O=S[0],y=S[1],N=Object(n.useState)(!1),w=Object(v.a)(N,2),j=w[0],I=w[1],A=null,T=Object(n.useRef)(null),k=function(e){i(e)};return Object(n.useEffect)(function(){F.on("DIALOGS:TYPING",function(e){return function(e){f(e.dialogId),I(!0),clearInterval(A),A=setTimeout(function(){I(!1),f(void 0)},2e3)}(e)})},[]),Object(n.useEffect)(function(){m.length?y(245):y(135)},[m]),Object(n.useEffect)(function(){return t&&a(t._id),F.on("SERVER:NEW_MESSAGE",k),function(){return F.removeListener("SERVER:NEW_MESSAGE",k)}},[t]),Object(n.useEffect)(function(){T.current.scrollTo(0,999999)},[c,j]),r.a.createElement(Ve,{user:s,me:d,blockRef:T,items:c,isLoading:o&&!s,onRemoveMessage:u,setPreviewImage:_,previewImage:h,blockHeight:O,isTyping:j,currentDialog:t,typingInDialogWithId:p,partner:s._id===t.partner._id?t.author:t.partner})}),ue=a(29),me=a.n(ue),de=a(85),fe=a(82),pe=Object(l.b)(function(e){var t=e.dialogs,a=e.attachments,n=e.user;return{dialogs:t,attachments:a.items,user:n.data}},Object(h.a)({},W,re))(function(e){var t=e.dialogs.currentDialogId,a=e.attachments,i=e.fetchSendMessage,c=e.setAttachments,s=e.removeAttachment,l=e.user;if(!t)return null;window.navigator.getUserMedia=window.navigator.getUserMedia||window.navigator.mozGetUserMedia||window.navigator.msGetUserMedia||window.navigator.webkitGetUserMedia;var o=Object(n.useState)(""),u=Object(v.a)(o,2),m=u[0],d=u[1],f=Object(n.useState)(""),p=Object(v.a)(f,2),g=p[0],E=p[1],h=Object(n.useState)(null),_=Object(v.a)(h,2),b=_[0],S=_[1],O=Object(n.useState)(!1),y=Object(v.a)(O,2),N=y[0],w=y[1],j=Object(n.useState)(!1),I=Object(v.a)(j,2),A=I[0],T=I[1],k=function(e){var t=new MediaRecorder(e);S(t),t.start(),t.onstart=function(){E(!0)},t.onstop=function(){E(!1)},t.ondataavailable=function(e){var t=new File([e.data],"audio.webm");T(!0),P(t).then(function(e){var t=e.data;L(t.file._id).then(function(){T(!1)})})}},D=function(e){console.log(e)},M=function(e,t){e&&!e.contains(t.target)&&w(!1)},L=function(e){return i({text:null,dialogId:t,attachments:[e]})},R=function(){g?b.stop():(m||a.length)&&(i({text:m,dialogId:t,attachments:a.map(function(e){return e.uid})}),d(""),c([]))},x=function(){var e=Object(fe.a)(me.a.mark(function e(t){var a,n,r;return me.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a=[],n=me.a.mark(function e(n){var r,i;return me.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t[n],i=Math.round(1e3*Math.random()),a=[].concat(Object(de.a)(a),[{uid:i,name:r.name,status:"uploading"}]),c(a),e.next=6,P(r).then(function(e){var t=e.data;a=a.map(function(e){return e.uid===i?{status:"done",uid:t.file._id,name:t.file.filename,url:t.file.url}:e})});case 6:case"end":return e.stop()}},e)}),r=0;case 3:if(!(r<t.length)){e.next=8;break}return e.delegateYield(n(r),"t0",5);case 5:r++,e.next=3;break;case 8:c(a);case 9:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}();return Object(n.useEffect)(function(){var e=document.querySelector(".chat-input__smile-btn");return document.addEventListener("click",M.bind(void 0,e)),function(){document.removeEventListener("click",M.bind(void 0,e))}},[]),r.a.createElement(rt,{value:m,setValue:d,emojiPickerVisible:N,toggleEmojiPicker:function(){w(!N)},addEmoji:function(e){var t=e.colons;d((m+" "+t).trim())},handleSendMessage:function(e){F.emit("DIALOGS:TYPING",{dialogId:t,user:l}),13===e.keyCode&&R()},sendMessage:R,onSelectFiles:x,attachments:a,isRecording:g,onRecord:function(){navigator.getUserMedia&&navigator.getUserMedia({audio:!0},k,D)},onHideRecording:function(){E(!1)},isLoading:A,removeAttachment:s})}),ge=Object(l.b)(function(e){var t=e.dialogs,a=e.user;return{dialogs:t.items,currentDialogId:t.currentDialogId,user:a.data}},Object(h.a)({},B))(function(e){var t=e.currentDialogId,a=e.user,n=e.dialogs,i=e.deleteDialog,c=e.history;if(!n.length||!t)return null;var s=n.filter(function(e){return e._id===t})[0],l={};return s&&(l=s.author._id===a._id?s.partner:s.author),r.a.createElement(at,{partner:l,deleteDialogById:function(e){i(e),c.push("/")}})}),Ee=Object(l.b)(function(e){return{user:e.user.data}},Object(h.a)({},ne))(function(e){var t=e.user,a=e.setOffline,i=e.allMessages,c=Object(n.useState)(!1),s=Object(v.a)(c,2),l=s[0],o=s[1],u=Object(n.useState)(""),m=Object(v.a)(u,2),d=m[0],f=m[1],p=Object(n.useState)(""),g=Object(v.a)(p,2),E=g[0],h=g[1],_=Object(n.useState)([]),b=Object(v.a)(_,2),S=b[0],O=b[1],y=Object(n.useState)(!1),w=Object(v.a)(y,2),j=w[0],I=w[1],A=Object(n.useState)(!1),T=Object(v.a)(A,2),k=T[0],D=T[1],M=function(){o(!1)};return r.a.createElement(Se,{allMessages:i,user:t,inputValue:d,visible:l,isLoading:j,onClose:M,onShow:function(){o(!0)},onSearch:function(e){I(!0),R(e).then(function(e){var t=e.data;O(t),I(!1)}).catch(function(){I(!1)})},onChangeInput:function(e){f(e)},onSelectUser:function(e){D(e)},onModalOk:function(){N({partner:k,text:E}).then(M).catch(function(){I(!1)})},onChangeTextArea:function(e){h(e.target.value)},onLogout:function(e){G(e),a(e),window.localStorage.clear(),window.location.reload()},messageText:E,selectedUserId:k,users:S})}),he=Object(l.b)(function(e){return{avatar:e.avatar}},Object(h.a)({},ne))(function(e){var t=e.setAvatar,a=e.user,i=Object(n.useState)(null),c=Object(v.a)(i,2),s=c[0],l=c[1],o=function(){var e=Object(fe.a)(me.a.mark(function e(a,n){var r,i,c,s;return me.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r=[],i=me.a.mark(function e(t){var n,i;return me.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=a[t],i=Math.round(1e3*Math.random()),r=[].concat(Object(de.a)(r),[{uid:i,name:n.name,status:"uploading"}]),e.next=5,P(n).then(function(e){var t=e.data;r=r.map(function(e){return e.uid===i?{status:"done",uid:t.file._id,name:t.file.filename,url:t.file.url}:e})});case 5:case"end":return e.stop()}},e)}),c=0;case 3:if(!(c<a.length)){e.next=8;break}return e.delegateYield(i(c),"t0",5);case 5:c++,e.next=3;break;case 8:r&&(s=r[0].url,n.avatar=s,t(n),x(n));case 9:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}();return r.a.createElement(tt,{user:a,onSelectAvatar:o,previewImage:s,setPreviewImage:l})}),ve=(a(444),p.a.Option),_e=d.a.TextArea,be=function(e){var t=e.user,a=e.visible,n=e.inputValue,i=e.messageText,c=e.selectedUserId,s=e.isLoading,l=e.users,o=e.onShow,u=e.onClose,d=e.onSearch,f=e.onChangeInput,h=e.onSelectUser,v=e.onChangeTextArea,_=e.onModalOk,b=e.onLogout,S=e.allMessages,O=l.map(function(e){return r.a.createElement(ve,{key:e._id},e.fullName)});return r.a.createElement("div",{className:"chat__sidebar"},r.a.createElement("div",{className:"chat__sidebar-header"},r.a.createElement("div",{className:"chat__sidebar-header-me"},t&&r.a.createElement(he,{user:t}),r.a.createElement("span",{className:"chat__sidebar-header-me-name"},t?t.fullName:"")),r.a.createElement("div",{className:"chat__sidebar-header-buttons"},r.a.createElement(g.a,{className:"chat__sidebar-header-logout",onClick:function(){return b(t)},type:"link",shape:"circle",icon:"logout",title:"\u0412\u044b\u0445\u043e\u0434"}),r.a.createElement(g.a,{className:"chat__sidebar-header-new-chat",onClick:o,type:"link",shape:"circle",icon:"form",title:"C\u043e\u0437\u0434\u0430\u0442\u044c \u043d\u043e\u0432\u044b\u0439 \u0447\u0430\u0442"}))),r.a.createElement("div",{className:"chat__sidebar-dialogs"},r.a.createElement(ie,{userId:t&&t._id,user:t,allMessages:S})),r.a.createElement(E.a,{title:"\u0421\u043e\u0437\u0434\u0430\u0442\u044c \u0434\u0438\u0430\u043b\u043e\u0433",visible:a,onCancel:u,footer:[r.a.createElement(g.a,{key:"back",onClick:u},"\u0417\u0430\u043a\u0440\u044b\u0442\u044c"),r.a.createElement(g.a,{disabled:!i,key:"submit",type:"primary",loading:s,onClick:_},"\u0421\u043e\u0437\u0434\u0430\u0442\u044c")]},r.a.createElement(m.a,{className:"add-dialog-form"},r.a.createElement(m.a.Item,{className:"ant-modal-label",label:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0438\u043c\u044f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f \u0438\u043b\u0438 E-Mail"},r.a.createElement(p.a,{value:n,onSearch:d,onChange:f,onSelect:h,notFoundContent:null,style:{width:"100%"},defaultActiveFirstOption:!1,showArrow:!1,filterOption:!1,placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0438\u043c\u044f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f \u0438\u043b\u0438 \u043f\u043e\u0447\u0442\u0443",showSearch:!0},O)),c&&r.a.createElement(m.a.Item,{label:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0442\u0435\u043a\u0441\u0442 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u044f"},r.a.createElement(_e,{autoSize:{minRows:3,maxRows:10},onChange:v,value:i})))))};be.defaultProps={users:[]};var Se=be,Oe=a(2),ye=a.n(Oe),Ne=(a(506),function(e){return r.a.createElement(g.a,Object.assign({},e,{className:ye()("button",e.className,{"button--large":"large"===e.size})}))}),we=(a(507),function(e){var t=e.children,a=e.className;return r.a.createElement("div",{className:ye()("block",a)},t)}),je=a(557),Ie=a(84),Ae=a(131),Te=a.n(Ae),ke=a(260),De=a.n(ke),Me=a(261),Le=a.n(Me),Re=a(262),xe=a.n(Re),Ce=(a(520),function(e){var t=e.audioSrc,a=Object(n.useRef)(null),i=Object(n.useState)(!1),c=Object(v.a)(i,2),s=c[0],l=c[1],o=Object(n.useState)(0),u=Object(v.a)(o,2),m=u[0],d=u[1],f=Object(n.useState)(0),p=Object(v.a)(f,2),g=p[0],E=p[1];return Object(n.useEffect)(function(){a.current.volume="0.01",a.current.addEventListener("playing",function(){l(!0)},!1),a.current.addEventListener("ended",function(){l(!1),d(0),E(0)},!1),a.current.addEventListener("pause",function(){l(!1)},!1),a.current.addEventListener("timeupdate",function(){var e=a.current&&a.current.duration||0;E(a.current.currentTime),d(a.current.currentTime/e*100)})},[]),r.a.createElement("div",{className:"message__audio"},r.a.createElement("audio",{ref:a,src:t,preload:"auto"}),r.a.createElement("div",{className:"message__audio-progress",style:{width:m+"%"}}),r.a.createElement("div",{className:"message__audio-info"},r.a.createElement("div",{className:"message__audio-btn"},r.a.createElement("button",{onClick:function(){s?a.current.pause():a.current.play()}},s?r.a.createElement("img",{src:xe.a,alt:"Pause svg"}):r.a.createElement("img",{src:Le.a,alt:"Play svg"}))),r.a.createElement("div",{className:"message__audio-wave"},r.a.createElement("img",{src:De.a,alt:"Wave svg"})),r.a.createElement("span",{className:"message__audio-duration"},function(e){var t=Math.floor(e/60),a=(e%60).toFixed();return"".concat(t<10?"0":"").concat(t,":").concat(a<10?"0":"").concat(a)}(g))))}),Ge=function(e){var t=e._id,a=e.user,n=e.text,i=e.date,c=e.isMe,s=e.read,o=e.attachments,u=e.isTyping,m=e.onRemoveMessage,d=e.setPreviewImage;n.includes("\u0422\u0435\u0441\u0442\u043e\u0432\u043e\u0435 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435")&&s?console.log("\u043f\u0440\u043e\u0447\u0438\u0442\u0430\u043d\u043e"):n.includes("\u0422\u0435\u0441\u0442\u043e\u0432\u043e\u0435 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435")&&!s&&console.log("\u043d\u0435 \u043f\u0440\u043e\u0447\u0438\u0442\u0430\u043d\u043e");var p=Object(l.c)(function(e){return e.messages.items});if(p){var E=p.find(function(e){return e._id===t});console.log(E)}return r.a.createElement("div",{className:ye()("message",{"message--isme":c,"message--is-typing":u,"message--is-audio":te(o),"message--image":!te(o)&&o&&1===o.length&&!n})},r.a.createElement("div",{className:"message__content"},r.a.createElement(qe,{isMe:c,isRead:s}),r.a.createElement(je.a,{content:r.a.createElement("div",null,r.a.createElement(g.a,{type:"danger",onClick:m},"\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435")),trigger:"click"},r.a.createElement("div",{className:"message__icon-actions"},r.a.createElement(g.a,{type:"link",shape:"circle"},r.a.createElement(f.a,{type:"ellipsis",className:"message__icon-actions-icon"})))),r.a.createElement("div",{className:"message__avatar"},r.a.createElement(Qe,{user:a})),r.a.createElement("div",{className:"message__info"},(n||u)&&r.a.createElement("div",{className:"message__bubble"},n&&r.a.createElement("p",{className:"message__text"},Te()(n,/:(.+?):/g,function(e,t){return r.a.createElement(Ie.a,{key:t,emoji:e,set:"apple",size:16})})),i&&r.a.createElement("span",{className:"message__date"},r.a.createElement(He,{date:i})),u&&r.a.createElement("div",{className:"message__typing"},r.a.createElement("span",null),r.a.createElement("span",null),r.a.createElement("span",null)),!1),o&&r.a.createElement("div",{className:"message__attachments"},o.map(function(e){return function(e){return"webm"!==e.ext?r.a.createElement("div",{key:e._id,onClick:function(){return d(e.url)},className:"message__attachments-item"},r.a.createElement("div",{className:"message__attachments-item-overlay"},r.a.createElement(f.a,{type:"eye",style:{color:"white",fontSize:18}})),r.a.createElement("img",{src:e.url,alt:e.filename})):r.a.createElement(Ce,{key:e._id,audioSrc:e.url})}(e)})))))};Ge.defaultProps={user:{}};var Ue=Ge,Pe=a(558),Ve=(a(521),function(e){var t=e.onRemoveMessage,a=e.blockRef,n=e.isLoading,i=e.items,c=e.user,s=e.previewImage,l=e.setPreviewImage,o=e.blockHeight,u=e.isTyping,m=e.typingInDialogWithId,d=e.partner,f=e.me,p=e.currentDialog;return r.a.createElement("div",{className:"chat__dialog-messages",style:{height:"calc(100% - ".concat(o,"px)")}},r.a.createElement("div",{ref:a,className:ye()("messages",{"messages--loading":n})},n&&!c?r.a.createElement(Pe.a,{size:"large",tip:"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0439..."}):i&&!n?i.length>0?i.map(function(e){return r.a.createElement(Ue,Object.assign({},e,{date:e.createdAt,dialog:e.dialog,isMe:c._id===e.user._id,partner:d,me:f,isTyping:!1,onRemoveMessage:t.bind(void 0,e._id),setPreviewImage:l,key:e._id}))}):r.a.createElement(ce.a,{description:"\u0414\u0438\u0430\u043b\u043e\u0433 \u043f\u0443\u0441\u0442",className:"chat__info-message"}):r.a.createElement(ce.a,{description:"\u041e\u0442\u043a\u0440\u043e\u0439\u0442\u0435 \u0434\u0438\u0430\u043b\u043e\u0433",className:"chat__info-message"}),u&&m===p._id&&r.a.createElement(Ue,{isTyping:!0,user:d}),r.a.createElement(E.a,{className:"image-preview",visible:!!s,onCancel:function(){return l(null)},footer:null},r.a.createElement("img",{src:s,style:{width:"100%"},alt:"Preview"}))))}),Fe=function(e){var t=e._id,a=e.unread,n=e.isMe,i=e.currentDialogId,c=e.author,o=e.partner,u=e.lastMessage,m=e.userId,d=e.isTyping,f=Object(l.c)(function(e){return e.messages.items}),p=Object(l.c)(function(e){return e.messages.allItems});if(p&&p.length&&i!==t&&(a=p.filter(function(e){return e.dialog===t&&e.user!==m&&!e.read}).length),f){var g=f.find(function(e){return e._id===u._id});g&&(u=g)}return r.a.createElement(s.b,{to:"/dialog/".concat(t)},r.a.createElement("div",{className:ye()("dialogs__item",{"dialogs__item--online":m===o._id?c.isOnline:o.isOnline,"dialogs__item--selected":i===t})},r.a.createElement("div",{className:"dialogs__item-avatar"},r.a.createElement(Qe,{user:m===o._id?c:o})),r.a.createElement("div",{className:"dialogs__item-info"},r.a.createElement("div",{className:"dialogs__item-info-top"},r.a.createElement("b",{className:"dialogs__item-into-top-name"},m===o._id?c.fullName:o.fullName),r.a.createElement("span",{className:"dialogs__item-into-top-time"},q(u.createdAt))),r.a.createElement("div",{className:"dialogs__item-info-bottom"},d?r.a.createElement("div",{className:"message__typing"},r.a.createElement("span",null),r.a.createElement("span",null),r.a.createElement("span",null)):r.a.createElement("p",null,Te()(function(e,t){var a="";return":"!==(a=!e.text&&e.attachments.length?"\u043f\u0440\u0438\u043a\u0440\u0435\u043f\u043b\u0435\u043d\u043d\u044b\u0439 \u0444\u0430\u0439\u043b":e.text)[0]?"".concat(e.user._id===t?"\u0412\u044b: ":"").concat(a):"".concat(e.user._id===t?"\u0412\u044b ":"").concat(a)}(u,m),/:(.+?):/g,function(e,t){return r.a.createElement(Ie.a,{key:t,emoji:e,set:"apple",size:16})})),u.user._id===m&&r.a.createElement(qe,{isMe:n,isRead:u.read}),a>0&&r.a.createElement("div",{className:"dialogs__item-info-bottom-count"},a>9?"+9":a)))))},ze=a(177),Be=a(270),He=function(e){var t=e.date;return Object(Be.a)(new Date(t))?r.a.createElement("div",{className:"message__time"},Object(ze.a)(new Date(t),"HH:mm")):r.a.createElement("div",{className:"message__time"},Object(ze.a)(new Date(t),"dd.MM"))},We=a(264),Ye=a.n(We),Ze=a(265),Je=a.n(Ze),qe=function(e){var t=e.isMe,a=e.isRead;return t&&(a?r.a.createElement("img",{className:"message__icon-read",src:Ye.a,alt:"Read icon"}):r.a.createElement("img",{className:"message__icon-read message__icon-read--no",src:Je.a,alt:"Not read icon"}))||null},Xe=a(266),Ke=a.n(Xe),$e=(a(534),function(e){var t=e.items,a=e.userId,n=e.onSearch,i=e.inputValue,c=e.currentDialogId,s=Object(l.c)(function(e){return e.dialogs.typingInDialogWithId});return r.a.createElement("div",{className:"dialogs"},r.a.createElement("div",{className:"dialogs__search"},r.a.createElement(d.a.Search,{className:"dialogs__search-input",placeholder:"\u041f\u043e\u0438\u0441\u043a \u0441\u0440\u0435\u0434\u0438 \u043a\u043e\u043d\u0442\u0430\u043a\u0442\u043e\u0432",onChange:function(e){return n(e.target.value)},value:i})),t.length?Ke()(t,["createdAt"],["desc"]).map(function(e){return r.a.createElement(Fe,Object.assign({key:e._id,isTyping:e._id===s,isMe:e.author._id===a,unread:e.unread,userId:a,currentDialogId:c},e))}):r.a.createElement(ce.a,{image:ce.a.PRESENTED_IMAGE_SIMPLE,style:{color:"rgba(255,255,255,.7)"},description:"\u041d\u0438\u0447\u0435\u0433\u043e \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u043e"}))}),Qe=(a(238),function(e){var t=e.user;if(t.avatar)return r.a.createElement("img",{className:"avatar",src:t.avatar,alt:"Avatar ".concat(t.fullName)});var a=$(t.fullName),n=a.color,i=a.colorLighten,c=t.fullName[0].toUpperCase();return r.a.createElement("div",{style:{background:"linear-gradient(135deg, ".concat(n," 0%, ").concat(i," 96.52%)")},className:"avatar avatar--symbol"},c)}),et=a(103),tt=function(e){var t=e.user,a=e.onSelectAvatar,n=e.previewImage,i=e.setPreviewImage,c=Object(l.c)(function(e){return e.user.data});if(t.avatar)return r.a.createElement("div",{className:"avatar-profile-container"},r.a.createElement("img",{className:"avatar-profile",src:t.avatar,alt:"Avatar ".concat(t.fullName)}),r.a.createElement("div",{className:"avatar-profile-buttons"},r.a.createElement("div",{className:"avatar-profile-button"},r.a.createElement(et.UploadField,{onFiles:function(e){return a(e,c)},containerProps:{className:"chat-input__actions-upload-btn"},uploadProps:{accept:".jpg,.jpeg,.png,.gif,.bmp",multiple:"multiple"}},r.a.createElement(g.a,{className:"avatar-profile-button-icon",type:"circle"},r.a.createElement(f.a,{className:"avatar-profile-button-icon",type:"cloud-upload"})))),r.a.createElement("div",{className:"avatar-profile-button"},r.a.createElement(g.a,{className:"avatar-profile-button-icon",type:"circle",onClick:function(){return i(t.avatar)},title:"\u0421\u043c\u043e\u0442\u0440\u0435\u0442\u044c"},r.a.createElement(f.a,{className:"avatar-profile-button-icon",type:"eye"})),r.a.createElement(E.a,{className:"image-preview",visible:!!n,onCancel:function(){return i(null)},footer:null},r.a.createElement("img",{src:n,style:{width:"100%"},alt:"Preview"})))));var s=$(t.fullName),o=s.color,u=s.colorLighten,m=t.fullName[0].toUpperCase();return r.a.createElement("div",{className:"avatar-profile-container"},r.a.createElement("div",{style:{background:"linear-gradient(135deg, ".concat(o," 0%, ").concat(u," 96.52%)")},className:"avatar-profile avatar--symbol"},m),r.a.createElement("div",{className:"avatar-profile-buttons"},r.a.createElement("div",{className:"avatar-profile-button"},r.a.createElement(et.UploadField,{onFiles:function(e){return a(e,c)},containerProps:{className:"chat-input__actions-upload-btn"},uploadProps:{accept:".jpg,.jpeg,.png,.gif,.bmp",multiple:"multiple"}},r.a.createElement(g.a,{className:"avatar-profile-button-icon",type:"circle"},r.a.createElement(f.a,{className:"avatar-profile-button-icon",type:"cloud-upload"})))),r.a.createElement("div",{className:"avatar-profile-button"},r.a.createElement(g.a,{className:"avatar-profile-button-icon",type:"circle",onClick:function(){return i(t.avatar)},title:"\u0421\u043c\u043e\u0442\u0440\u0435\u0442\u044c",style:{opacity:"0"}},r.a.createElement(f.a,{className:"avatar-profile-button-icon",type:"eye"})))))},at=(a(539),function(e){var t=e.partner,a=e.deleteDialogById,n=Object(l.c)(function(e){return e.dialogs.currentDialogId});return r.a.createElement("div",{className:"chat__dialog-header"},r.a.createElement("div",{className:"chat__dialog-header-center"},r.a.createElement("b",{className:"chat__dialog-header-username"},t.fullName),r.a.createElement("div",{className:"chat__dialog-header-status"},t.isOnline?r.a.createElement("span",{className:"status status--online"},"\u0412 \u0441\u0435\u0442\u0438"):r.a.createElement("span",{className:"status--offline"},q(t.last_seen)))),r.a.createElement(je.a,{className:"chat__dialog-header-action",content:r.a.createElement("div",null,r.a.createElement(g.a,{type:"danger",onClick:function(){return a(n)}},"\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u0434\u0438\u0430\u043b\u043e\u0433")),trigger:"click"},r.a.createElement("div",null,r.a.createElement(g.a,{type:"link",shape:"circle"},r.a.createElement(f.a,{type:"ellipsis",style:{color:"white"}})))))}),nt=(a(540),d.a.TextArea),rt=function(e){var t=e.emojiPickerVisible,a=e.value,i=e.addEmoji,c=e.setValue,s=e.handleSendMessage,l=e.sendMessage,o=e.toggleEmojiPicker,u=e.attachments,m=e.onSelectFiles,d=e.isRecording,p=e.onRecord,E=e.onHideRecording,h=e.removeAttachment,v=e.isLoading;return r.a.createElement(n.Fragment,null,r.a.createElement("div",{className:"chat-input"},r.a.createElement("div",null,r.a.createElement("div",{className:"chat-input__smile-btn"},r.a.createElement("div",{className:"chat-input__emoji-picker"},t&&r.a.createElement(Ie.b,{onSelect:function(e){return i(e)},set:"apple"})),r.a.createElement(g.a,{className:"chat-input-button",onClick:o,type:"link",shape:"circle"},r.a.createElement(f.a,{type:"smile",className:"chat-input-icon"}))),d?r.a.createElement("div",{className:"chat-input__record-status"},r.a.createElement("i",{className:"chat-input__record-status-bubble"}),"Recording...",r.a.createElement(g.a,{onClick:E,type:"link",shape:"circle",className:"stop-recording chat-input-button"},r.a.createElement(f.a,{type:"close",className:"chat-input-icon"}))):r.a.createElement(nt,{onChange:function(e){return c(e.target.value)},id:"chatTextarea",onKeyUp:s,className:"chat-input-textarea",size:"large",placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0442\u0435\u043a\u0441\u0442 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u044f\u2026",value:a,autoSize:{minRows:1,maxRows:6}}),r.a.createElement("div",{className:"chat-input__actions"},r.a.createElement(et.UploadField,{onFiles:m,containerProps:{className:"chat-input__actions-upload-btn"},uploadProps:{accept:".jpg,.jpeg,.png,.gif,.bmp",multiple:"multiple"}},r.a.createElement(g.a,{className:"chat-input__button",type:"link",shape:"circle"},r.a.createElement(f.a,{type:"camera",className:"chat-input-icon"}))),v?r.a.createElement(g.a,{className:"chat-input__button",type:"link",shape:"circle"},r.a.createElement(f.a,{type:"loading",className:"chat-input-icon"})):d||a||u.length?r.a.createElement(g.a,{className:"chat-input__button",onClick:l,type:"link",shape:"circle"}," ",r.a.createElement(f.a,{type:"check-circle",className:"chat-input-icon"})):r.a.createElement("div",{className:"chat-input__record-btn"},r.a.createElement(g.a,{className:"chat-input__button",onClick:p,type:"link",shape:"circle"},r.a.createElement(f.a,{type:"audio",className:"chat-input-icon"}))))),u.length>0&&r.a.createElement("div",{className:"chat-input__attachments",style:{position:"relative",top:"-180px"}},r.a.createElement(ot,{removeAttachment:h,attachments:u}))))},it=function(e){var t=e.name,a=e.placeholder,n=e.icon,i=e.type,c=e.handleChange,s=e.handleBlur,l=e.touched,o=e.errors,u=e.values;return r.a.createElement(m.a.Item,{validateStatus:Y(t,l,o),help:l[t]?o[t]:"",hasFeedback:!0},r.a.createElement(d.a,{id:t,prefix:r.a.createElement(f.a,{type:n,style:{color:"rgba(0,0,0,.25)"}}),size:"large",placeholder:a,value:u[t],onChange:c,onBlur:s,type:i}))},ct=a(559);function st(e){return new Promise(function(t,a){var n=new FileReader;n.readAsDataURL(e),n.onload=function(){return t(n.result)},n.onerror=function(e){return a(e)}})}var lt=function(e){var t=e.attachments,a=e.removeAttachment,i=Object(n.useState)({previewVisible:!1,previewImage:"",fileList:t}),c=Object(v.a)(i,2),s=c[0],l=c[1];Object(n.useEffect)(function(){l(Object(h.a)({},s,{fileList:t}))},[t]);var o=function(){var e=Object(fe.a)(me.a.mark(function e(t){return me.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.url||t.preview){e.next=4;break}return e.next=3,st(t.originFileObj);case 3:t.preview=e.sent;case 4:l(Object(h.a)({},s,{previewImage:t.url||t.preview,previewVisible:!0}));case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}();return r.a.createElement("div",{className:"clearfix"},r.a.createElement(ct.a,{action:"https://www.mocky.io/v2/5cc8019d300000980a055e76",listType:"picture-card",fileList:s.fileList,onPreview:o,onChange:function(e){var t=e.fileList;return l(Object(h.a)({},s,{fileList:t}))},onRemove:function(e){return a(e)}}),r.a.createElement(E.a,{className:"image-preview",visible:s.previewVisible,footer:null,onCancel:function(){return l(Object(h.a)({},s,{previewVisible:!1}))}},r.a.createElement("img",{alt:"example",style:{width:"100%"},src:s.previewImage})))};lt.defaultProps={attachments:[]};var ot=lt,ut=function(e){var t=e.values,a=e.touched,n=e.errors,i=e.handleChange,c=e.handleBlur,l=e.handleSubmit,o=e.isValid,u=e.isSubmitting;return r.a.createElement("div",null,r.a.createElement("div",{className:"auth__top"},r.a.createElement("h2",{className:"auth__top-header"},"\u0412\u043e\u0439\u0442\u0438 \u0432 \u0430\u043a\u043a\u0430\u0443\u043d\u0442"),r.a.createElement("p",{className:"auth__top-sub-header"},"\u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u0432\u043e\u0439\u0434\u0438\u0442\u0435 \u0432 \u0441\u0432\u043e\u0439 \u0430\u043a\u043a\u0430\u0443\u043d\u0442")),r.a.createElement(we,null,r.a.createElement(m.a,{onSubmit:l,className:"login-form"},r.a.createElement(m.a.Item,{validateStatus:Y("email",a,n),help:a.email?n.email:"",hasFeedback:!0},r.a.createElement(d.a,{id:"email",prefix:r.a.createElement(f.a,{type:"mail",style:{color:"rgba(0,0,0,.25)"}}),size:"large",placeholder:"E-Mail",value:t.email,onChange:i,onBlur:c})),r.a.createElement(m.a.Item,{validateStatus:Y("password",a,n),help:a.password?n.password:"",hasFeedback:!0},r.a.createElement(d.a,{id:"password",prefix:r.a.createElement(f.a,{type:"lock",style:{color:"rgba(0,0,0,.25)"}}),size:"large",type:"password",placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c",value:t.password,onChange:i,onBlur:c})),r.a.createElement(m.a.Item,null,u&&!o&&r.a.createElement("span",null,"\u041e\u0448\u0438\u0431\u043a\u0430!"),r.a.createElement(Ne,{disabled:u,onClick:l,type:"primary",size:"large"},"\u0412\u043e\u0439\u0442\u0438 \u0432 \u0430\u043a\u043a\u0430\u0443\u043d\u0442")),r.a.createElement(s.b,{className:"auth__register-link",to:"/signup"},"\u0417\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f"))))},mt=function(e){var t=e.isAuth,a=e.values,n=e.errors,r={email:function(e){e?/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}$/i.test(e)||(n.email="\u041d\u0435\u0432\u0435\u0440\u043d\u044b\u0439 E-Mail"):n.email="\u0412\u0432\u0435\u0434\u0438\u0442\u0435 E-Mail"},password:function(e){e?t||/^(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])(?=.{8,})/.test(e)||(n.password="\u041f\u0430\u0440\u043e\u043b\u044c \u0434\u043e\u043b\u0436\u0435\u043d \u0432\u043a\u043b\u044e\u0447\u0430\u0442\u044c: 6 \u0438\u043b\u0438 \u0431\u043e\u043b\u044c\u0448\u0435 \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432, \u043c\u0438\u043d\u0438\u043c\u0443\u043c \u043e\u0434\u043d\u0443 \u0441\u0442\u0440\u043e\u0447\u043d\u0443\u044e \u0438 \u043e\u0434\u043d\u0443 \u0437\u0430\u0433\u043b\u0430\u0432\u043d\u0443\u044e \u0431\u0443\u043a\u0432\u044b"):n.password="\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043f\u0430\u0440\u043e\u043b\u044c"},password_2:function(e){t||e===a.password?e||(n.password_2="\u041f\u043e\u0432\u0442\u043e\u0440\u0438\u0442\u0435 \u043f\u0430\u0440\u043e\u043b\u044c"):n.password_2="\u041f\u0430\u0440\u043e\u043b\u0438 \u043d\u0435 \u0441\u043e\u0432\u043f\u0430\u0434\u0430\u044e\u0442"},fullName:function(e){t||e||(n.fullName="\u0423\u043a\u0430\u0436\u0438\u0442\u0435 \u0441\u0432\u043e\u0435 \u0438\u043c\u044f \u0438 \u0444\u0430\u043c\u0438\u043b\u0438\u044e")}};Object.keys(a).forEach(function(e){return r[e]&&r[e](a[e])})},dt=a(60),ft=a(268),pt=a(97),gt=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||dt.d,Et=[ft.a],ht=Object(dt.e)(pt.default,gt(dt.a.apply(void 0,Et))),vt=Object(u.a)({enableReinitialize:!0,mapPropsToValues:function(){return{email:"",password:""}},validate:function(e){var t={};return mt({isAuth:!0,values:e,errors:t}),t},handleSubmit:function(e,t){var a=t.setSubmitting,n=t.props;ht.dispatch(ne.fetchUserLogin(e)).then(function(e){"success"===e.status&&n.history.push("/"),a(!1)}).catch(function(){a(!1)})},displayName:"LoginForm"})(ut),_t=a(71),bt=a.n(_t),St=function(e){var t=e.values,a=e.touched,n=e.errors,i=e.handleChange,c=e.handleBlur,l=e.handleSubmit,o=e.isValid,u=e.isSubmitting;return r.a.createElement("div",null,r.a.createElement("div",{className:"auth__top"},r.a.createElement("h2",null,"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f"),r.a.createElement("p",null,"\u0414\u043b\u044f \u0432\u0445\u043e\u0434\u0430 \u0432 \u0447\u0430\u0442, \u0432\u0430\u043c \u043d\u0443\u0436\u043d\u043e \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f")),r.a.createElement(we,null,r.a.createElement(m.a,{onSubmit:l,className:"login-form"},r.a.createElement(it,{name:"email",icon:"mail",placeholder:"E-Mail",handleChange:i,handleBlur:c,touched:a,errors:n,values:t}),r.a.createElement(it,{name:"fullName",icon:"user",placeholder:"\u0412\u0430\u0448\u0435 \u0438\u043c\u044f \u0438 \u0444\u0430\u043c\u0438\u043b\u0438\u044f",handleChange:i,handleBlur:c,touched:a,errors:n,values:t}),r.a.createElement(it,{name:"password",icon:"lock",placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c",type:"password",handleChange:i,handleBlur:c,touched:a,errors:n,values:t}),r.a.createElement(it,{name:"password_2",icon:"lock",placeholder:"\u041f\u043e\u0432\u0442\u043e\u0440\u0438\u0442\u0435 \u043f\u0430\u0440\u043e\u043b\u044c",type:"password",handleChange:i,handleBlur:c,touched:a,errors:n,values:t}),r.a.createElement(m.a.Item,null,u&&!o&&r.a.createElement("span",null,"\u041e\u0448\u0438\u0431\u043a\u0430!"),r.a.createElement(Ne,{disabled:u,onClick:l,type:"primary",size:"large"},"\u0417\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f")),r.a.createElement(s.b,{className:"auth__register-link",to:"/signin"},"\u0412\u043e\u0439\u0442\u0438 \u0432 \u0430\u043a\u043a\u0430\u0443\u043d\u0442"))))},Ot=Object(u.a)({enableReinitialize:!0,mapPropsToValues:function(){return{email:"",fullName:"",password:"",password_2:""}},validate:function(e){var t={};return mt({isAuth:!1,values:e,errors:t}),t},handleSubmit:function(e,t){var a=t.setSubmitting,n=t.props;ht.dispatch(ne.fetchUserRegister(e)).then(function(){n.history.push("/signup/verify"),a(!1)}).catch(function(e){bt()(e,"response.data.message.errmsg","").indexOf("dup")>=0?ee({title:"\u041e\u0448\u0438\u0431\u043a\u0430",text:"\u0410\u043a\u043a\u0430\u0443\u043d\u0442 \u0441 \u0442\u0430\u043a\u043e\u0439 \u043f\u043e\u0447\u0442\u043e\u0439 \u0443\u0436\u0435 \u0441\u043e\u0437\u0434\u0430\u043d.",type:"error",duration:5e3}):ee({title:"\u041e\u0448\u0438\u0431\u043a\u0430",text:"\u0412\u043e\u0437\u043d\u0438\u043a\u043b\u0430 \u0441\u0435\u0440\u0432\u0435\u0440\u043d\u0430\u044f \u043e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u0438. \u041f\u043e\u0432\u0442\u043e\u0440\u0438\u0442\u0435 \u043f\u043e\u0437\u0436\u0435.",type:"error",duration:5e3}),a(!1)})},displayName:"RegisterForm"})(St),yt=a(565),Nt=function(e){var t=e.hash,a=e.verified;return t?a?{status:"success",title:"\u0413\u043e\u0442\u043e\u0432\u043e!",message:"\u0410\u043a\u043a\u0430\u0443\u043d\u0442 \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u043f\u043e\u0434\u0442\u0432\u0435\u0440\u0436\u0434\u0435\u043d!"}:{status:"error",title:"\u041e\u0448\u0438\u0431\u043a\u0430",message:"\u0412\u044b \u0443\u043a\u0430\u0437\u0430\u043b\u0438 \u043d\u0435\u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u044e\u0449\u0438\u0439 \u0438\u043b\u0438 \u043d\u0435\u0432\u0435\u0440\u043d\u044b\u0439 \u0445\u0435\u0448."}:{status:"info",title:"\u041f\u043e\u0434\u0442\u0432\u0435\u0440\u0434\u0438\u0442\u0435 \u043f\u043e\u0447\u0442\u0443",message:"\u0421\u0441\u044b\u043b\u043a\u0430 \u0441 \u043f\u043e\u0434\u0442\u0432\u0435\u0440\u0436\u0434\u0435\u043d\u0438\u0435\u043c \u0430\u043a\u043a\u0430\u0443\u043d\u0442\u0430 \u043e\u0442\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0430 \u043d\u0430 E-Mail."}},wt=function(e){var t=e.location,a=e.history,i=t.search.split("hash=")[1],c=Object(n.useState)(!1),s=Object(v.a)(c,2),l=s[0],o=s[1],u=Object(n.useState)(!!i),m=Object(v.a)(u,2),d=m[0],f=m[1],p=Object(n.useState)(Nt({hash:i,checking:d,verified:l})),E=Object(v.a)(p,2),h=E[0],_=E[1],b=function(e){var t=e.checking,a=e.verified;_(Nt({hash:i,checking:t,verified:a})),o(a),f(t)};return Object(n.useEffect)(function(){i&&M(i).then(function(){b({verified:!0,checking:!1})}).catch(function(){b({verified:!1,checking:!1})})},[]),console.log({info:h,checking:d,verified:l,hash:i}),r.a.createElement("div",{className:"verify-block"},r.a.createElement(we,null,d?r.a.createElement("div",{className:"verify-block__loading"},r.a.createElement(Pe.a,{size:"large"})):r.a.createElement(yt.a,{status:h.status,title:h.title,subTitle:h.message,extra:"success"===h.status&&l&&r.a.createElement(g.a,{type:"primary",className:"success-verification",onClick:function(){return a.push("/signin")}},"\u0412\u043e\u0439\u0442\u0438")})))},jt=(a(550),function(){return r.a.createElement("section",{className:"auth"},r.a.createElement("div",{className:"auth__content"},r.a.createElement(o.b,{exact:!0,path:"/signin",component:vt}),r.a.createElement(o.b,{exact:!0,path:"/signup",component:Ot}),r.a.createElement(o.b,{exact:!0,path:"/signup/verify",component:wt})))}),It=(a(551),Object(o.g)(Object(l.b)(function(e){return{user:e.user.data}},Object(h.a)({},B,ne,W))(function(e){var t=e.setCurrentDialogId,a=e.user,i=e.setOnline,c=e.setOffline;return a&&!a.isOnline&&(i(a),C(a)),document.addEventListener("onunload",function(){c(a),G(a)}),Object(n.useEffect)(function(){var a=e.location.pathname.split("/").pop();t(a)},[e.location.pathname]),r.a.createElement("section",{className:"home"},r.a.createElement("div",{className:"chat"},r.a.createElement(Ee,{me:a}),a&&r.a.createElement("div",{className:"chat__dialog"},r.a.createElement(ge,{history:e.history}),r.a.createElement(oe,{me:a}),r.a.createElement("div",{className:"chat__dialog-input"},r.a.createElement(pe,null)))))}))),At=Object(l.b)(function(e){return{isAuth:e.user.isAuth}})(function(e){var t=e.isAuth;return r.a.createElement("div",{className:"wrapper"},r.a.createElement(o.d,null,r.a.createElement(o.b,{exact:!0,path:["/signin","/signup","/signup/verify"],component:jt}),r.a.createElement(o.b,{path:"/",render:function(){return t?r.a.createElement(It,null):r.a.createElement(o.a,{to:"/signin"})}})))});a(552),a(553);ht.dispatch(ne.fetchUserData()),c.a.render(r.a.createElement(l.a,{store:ht},r.a.createElement(s.a,null,r.a.createElement(At,null))),document.getElementById("root"))},97:function(e,t,a){"use strict";a.r(t);var n=a(60);t.default=Object(n.c)(["messages","dialogs","user","attachments"].reduce(function(e,t){return e[t]=a(549)("./".concat(t)).default,e},{}))}},[[274,1,2]]]);
//# sourceMappingURL=main.771a0ce1.chunk.js.map